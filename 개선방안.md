# Dynamic Shield v3.0 → v4.0 고도화 개선방안

https://github.com/bucheoncityboy/Dynamic-Shield-K-ICS-AI

> **K-ICS 규제 환경 하 보험사의 동적 환위험 헤지 의사결정 시스템 고도화 및 논리적 결함 보정**

---

## 1. 개요 및 목적

본 문서는 Dynamic Shield 시스템(v3.0)의 기존 제안서를 비판적으로 검토하고, 발견된 **데이터 정합성 오류, 용어 오용, 규제 산식과의 논리적 충돌**을 보정하는 데 목적이 있다. 핵심 아이디어인 'Natural Hedge 활용을 통한 자본 효율성 증대'는 타당하나, 이를 뒷받침하는 데이터와 규제적 논리를 대폭 강화해야 한다.

---

## 2. 기존 시스템의 논리적 허점 및 보정 사항

### 2.1. 🚨 [치명적] 헤지 비용 데이터의 비현실성

| 항목 | 기존 (v3.0) | 보정 (v4.0) |
|------|------------|------------|
| 100% Hedge 연간 비용 | **60.00%** | **1.0~2.0%** |
| 근거 | 없음 | CRS/FX Swap 스왑포인트 기반 |
| 참고 데이터 | — | 보험연구원 추정 1.3~1.5% (2018 기준) |

**문제:** 연간 60%의 헤지 비용은 자산 가치의 절반 이상을 매년 소모한다는 의미로, 현실에서 존재할 수 없는 수치이다. 보험사의 환헤지 비용은 양국 간 내외 금리차와 스왑베이시스에 의해 결정되며, 한-미 금리 역전이 심화된 시기에도 연간 **2~5% 내외**였다.

**영향:** 이 수치를 기반으로 AI 모델의 비용 절감 효과를 입증하면 '허수아비 공격의 오류(Straw Man Fallacy)'에 해당하며, 심사에서 모델 신뢰성이 무너진다.

**조치:**
- `src/core/environment.py`의 헤지 비용 파라미터를 현실적인 스왑포인트(연간 1~2%)로 교체
- `src/validation/backtest.py`의 성과 비교 테이블 전면 재계산
- RCR 지표를 현실적 비용 기반으로 재산출

---

### 2.2. ⚠️ 'Risk Paradox' 용어의 개념적 혼선 → 용어 교체

| 항목 | 기존 (v3.0) | 보정 (v4.0) |
|------|------------|------------|
| 용어 | Risk Paradox (리스크 역설) | **분산 효과 최적화 (Diversification Optimization)** |
| 정의 | 부분 헤지 > 100% 헤지 | K-ICS 상관계수 구조 하에서의 최적 헤지 도출 |

**문제:** 기존 v3.0에서 사용한 'Risk Paradox(리스크 역설)'라는 용어는 학술적으로 전혀 다른 의미이다:
- **Rampini (Duke):** 리스크 관리가 가장 절실한 기업이 자본 부족으로 헤지를 못하는 역설
- **시스템 리스크:** 개별 위험 관리 고도화가 시스템 전체 위기를 초래하는 현상

**조치 (✅ 완료):**
- 전체 문서 및 코드에서 'Risk Paradox' → **'분산 효과 최적화 (Diversification Optimization)'**로 변경 완료
- `proof_risk_paradox.py` → `proof_diversification.py` 파일명 변경 완료
- README.md 및 발표 자료의 용어 통일 완료

---

### 2.3. ⚠️ K-ICS 표준모형 상관계수와의 논리적 충돌

**문제:** K-ICS 표준모형은 주식-외환 간 상관계수를 **-0.25로 고정** 적용한다. AI가 실제 시장 데이터로 동적 상관관계(-0.6 등)를 인식하여 헤지를 줄여도, 표준모형을 사용하는 한 규제상 SCR은 고정 상관계수 기준으로 산출된다.

**조치:**
- 시스템 설계 시 **표준모형/내부모형 이중 트랙** 지원 명시
- 내부모형 승인을 전제로 한 장기 로드맵 수립 (2026년 금감원 내부모형 허용 예정)
- `src/core/kics_real.py`에 표준모형 모드 (`rho=-0.25` 고정)와 내부모형 모드 (동적 `rho`) 분리 구현

---

## 3. 시스템 아키텍처 고도화

### 3.1. HMM 국면 인식 모델 고도화

**기존:** 환율 시계열만 분석 → 가짜 국면(false regime) 인식 위험

**개선:** 다변량 관측 변수(Observation Variables) 통합

| 변수 분류 | 세부 변수 | 역할 |
|-----------|----------|------|
| **매크로-금융** | 한-미 금리차, 스왑베이시스, VIX, TED Spread | 체계적 위험/달러 유동성 상태 반영 |
| **K-ICS 민감도** | 금리 충격 시나리오 하 자본비율 변화 | 규제적 제약 강화 구간 인지 |
| **동적 상관관계** | 주식-환율 60일 이동 상관계수 추이 | 실시간 분산 효과 포착 |

**국면 세분화** (3단계 → 4단계):

| 국면 | 상관계수 (ρ) 범위 | 최적 헤지 비율 | SCR 절감률 | 헤지 비용 절감률 |
|------|:---:|:---:|:---:|:---:|
| **Normal** (안정적 저비용) | -0.1 ~ 0.1 | 90~100% | 0.0% | 0.0% |
| **Transition** (변동성 확대) | -0.4 ~ -0.2 | 50~70% | 2.5% | 35.0% |
| **Safe-haven** (음의 상관 극대) | -0.7 ~ -0.5 | 0~30% | 8.0% | 75.0% |
| **Panic** (상관 역전/유동성 경색) | 0.3 ~ 0.5 | 100% (강제) | -2.0% | -10.0% |

**대상 파일:** `src/core/regime.py`

---

### 3.2. PPO 보상함수 제약 조건부 최적화

**기존:** 단순 비용 절감 중심 보상

**개선:** 라그랑주 승수법(Lagrangian Multipliers) 기반 제약 조건부 최적화

```
Objective:  max E[Σ (SCR절감 - λ₁·헤지비용 - λ₂·턴오버페널티)]
Constraint: K-ICS Ratio ≥ 150% (또는 보험사 내부 관리 한도)
```

**추가 보상 요소:**

| 요소 | 설명 | 근거 |
|------|------|------|
| **턴오버 페널티** | 헤지 비율 변경 강도에 비례하는 패널티 | 거래비용(Commission)/시장충격(Slippage) 반영 |
| **PPO 클리핑** | 급격한 정책 변화 억제 | 규제 준수의 연속성 담보 |
| **규제 위반 페널티** | K-ICS 100% 미만 시 거대 음의 보상 | Safety Layer와 연동 |

**대상 파일:** `src/core/environment.py`, `src/core/ppo_trainer.py`

---

### 3.3. Surrogate 모델 신뢰성 강화

**기존:** MAPE 0.0518% (평균 정확도만 측정)

**문제:** 금융 규제 관점에서는 '꼬리 위험(Tail Risk)'에서의 정확도가 더 중요하다. 자본비율이 100%에 근접하는 위기 국면에서 예측 오차가 커지면 치명적 의사결정 유발.

**개선:**
- **퀀타일 회귀(Quantile Regression)** 도입: 자본비율의 하방 신뢰 구간을 보수적으로 예측
- 위기 국면(SCR 급등 구간)에서의 예측 오차를 별도 모니터링
- Surrogate 오차가 임계값 초과 시 실제 K-ICS 엔진으로 자동 폴백

**대상 파일:** `src/core/kics_surrogate.py`

---

### 3.4. 다단계 Safety Layer 체계화

**기존:** VIX > 40 시 Emergency De-risking + K-ICS < 100% 시 강제 100% 헤지

**개선:** 3단계 Safety Layer로 체계화

| 단계 | 발동 조건 | 개입 조치 | 규제적 근거 |
|:---:|-----------|-----------|------------|
| **Level 1** | K-ICS Ratio < 130% | 헤지 비율 점진적 상향 (De-risking) | 적기시정조치 예방 |
| **Level 2** | VIX > 40 또는 스왑포인트 급락 | 즉시 100% 헤지 전환 + 신규 노출 금지 | 시장 유동성 위기 대응 |
| **Level 3** | 자본 감소액 > 분기 이익 한도 | 손절매(Stop-loss) 및 노출 포지션 청산 | 재무 건전성 유지 |

**대상 파일:** `src/safety/risk_control.py`

---

### 3.5. SHAP 기반 의사결정 투명성 확보 (XAI)

**목적:** "왜 지금 헤지 비율을 60%로 낮추었는가?"라는 감독기관의 질문에 정량적으로 답변.

**개선:**
- SHAP 분석을 통해 각 의사결정에 대한 변수별 기여도를 정량적으로 제시
  - 주식-환율 상관계수, VIX, 현재 K-ICS 비율 등의 기여분 분해
- AI 모델이 합리적인 경제적 유인과 규제적 제약 하에서 움직이고 있음을 입증
- 감독기관 보고용 자동 리포트 생성 기능 추가

**대상 파일:** `src/validation/shap_analysis.py`

---

## 4. 성과 지표 보정

### 4.1. RCR(Risk-Cost Ratio) 보정

기존 비현실적 비용(60%)을 현실적 스왑포인트(1~2%)로 교체 후 재계산:

| 전략 | 평균 K-ICS 비율 | SCR 변동성 | 연간 헤지 비용 | RCR |
|------|:---:|:---:|:---:|:---:|
| 100% Hedge (Base) | 203.4% | High | **1.5%** | 1.00 |
| 80% Fixed | 198.5% | Medium | 1.2% | 1.15 |
| Rule-based | 205.2% | Medium | 1.1% | 1.42 |
| **Proposed AI** | **218.7%** | **Low** | **0.4%** | **재계산 필요** |

> **참고:** 기존 RCR 27.41은 비현실적 비용 기반 산출이므로 현실적 비용으로 재계산 필수

---

## 5. 규제적 수용성 및 내부모형 도입 로드맵

### 5.1. 내부모형 승인 절차 (2026년~)

금융감독원은 2026년부터 보험사가 자체 개발한 내부모형으로 지급여력비율을 산출하도록 허용할 계획이다.

| 단계 | 내용 | 핵심 요구사항 |
|:---:|------|-------------|
| 1 | 사전 협의 | 모델 개요 및 적용 범위 합의 |
| 2 | 승인 신청 | 양적 기준(정확도, 데이터 무결성) 충족 |
| 3 | 승인 심사 | 질적 기준(거버넌스, 내부 통제, 모델 리스크 관리) |
| 4 | 결정·통보 | AI 편향성 및 극단 상황 안정성 입증 |
| 5 | 사후 검증 | 지속적 모니터링 및 재검증 |

### 5.2. 전사적 리스크 관리(ERM) 통합

| 영역 | 통합 방안 |
|------|----------|
| **ALM 연계** | 보험부채 특성에 따른 환율 영향을 자산-부채 통합 관점에서 헤지 비율 결정 |
| **유동성 리스크** | 헤지 비율 급상향 시 Margin Call 대비 유동성 확보 모델 반영 |
| **거버넌스** | AI 의사결정에 대한 최종 승인권 및 책임 소재 명확화 |

---

## 6. 향후 확장 방향

| 영역 | 내용 | 우선순위 |
|------|------|:---:|
| 다중 통화(Multi-currency) | 원-달러 외 베트남 동, 유로 등 확장 | 중 |
| 금리 리스크 동시 최적화 | ALM과 연계한 금리-환율 통합 최적화 | 높음 |
| 장중(Intra-day) 의사결정 | 실시간 데이터 연동 기반 장중 헤지 조정 | 중 |
| TimeGAN 데이터 증강 | 위기 시나리오 합성 데이터 생성 (`timegan_model/`) | 낮음 |

---

## 7. 개선 우선순위 종합

```
┌────────────────────────────────────────────────────────────────┐
│                    개선 우선순위 로드맵                          │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  [P0 - 긴급] 헤지 비용 파라미터 60% → 1~2%로 교체              │
│      └── environment.py, backtest.py, 성과 테이블 재계산        │
│                                                                │
│  [P1 - 높음] HMM 다변량 변수 통합 (3→4 국면)                   │
│      └── regime.py + 매크로 데이터 수집                         │
│                                                                │
│  [P1 - 높음] PPO 보상함수 리디자인 (제약 조건부 최적화)          │
│      └── environment.py, ppo_trainer.py                        │
│                                                                │
│  [P2 - 중간] Safety Layer 3단계 체계화                          │
│      └── risk_control.py                                       │
│                                                                │
│  [P2 - 중간] Surrogate 모델 퀀타일 회귀 추가                    │
│      └── kics_surrogate.py                                     │
│                                                                │
│  [P2 - 중간] SHAP XAI 감독기관 보고서 자동화                    │
│      └── shap_analysis.py                                      │
│                                                                │
│  [P3 - 완료] 용어 정비 (Risk Paradox → 분산 효과 최적화)             │
│      └── 전체 문서 및 코드 (✅ 반영 완료)                        │
│                                                                │
│  [P3 - 낮음] 표준모형/내부모형 이중 트랙 구현                     │
│      └── kics_real.py                                          │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

---

## 참고 문헌

1. 금융위원회, "K-ICS(신지급여력제도) 도입 관련 보도자료," https://www.fsc.go.kr/no010101/84128
2. RNA Analytics, "South Korea – at a crossroads," https://www.rnaanalytics.com/newsblog/south-korea-at-a-crossroads
3. 보험연구원, "K-ICS 내부모형 도입: 필요성과 방안," https://www.kiri.or.kr/report/downloadFile.do?docId=473389
4. 보험연구원, "보험회사 해외채권투자와 환헤지," https://www.kiri.or.kr/report/downloadFile.do?docId=119
5. 보험연구원, "K-ICS 주요 내용," http://www.kiri.or.kr/pdf/연구자료/연구보고서/nre2024-14_2.pdf
6. 한국금융연구원, "국내 생명보험회사의 환헤지 행태 및 환헤지규제," https://www.kif.re.kr/kif4/publication/viewer?mid=15
7. 기존 제안서 (Dynamic Shield v3.0 데이터 명세서)
8. 보험연구원, "보험회사 환헤지 비용의 특성," https://www.kiri.or.kr/pdf/전문자료/KIRI_20190830_95647.pdf
9. 보험연구원, "보험회사의 환헤지 현황과 문제점," https://www.kiri.or.kr/pdf/전문자료/KIRI_20170623_142041.pdf
10. Rampini, A., "Untangling the Risk Management Paradox," Duke Fuqua, https://www.fuqua.duke.edu/duke-fuqua-insights/adriano-rampini-untangling-risk-management-paradox
11. ResearchGate, "Financial Innovations and the Risk Paradox," https://www.researchgate.net/publication/255727472
12. Columbia, "The Systemic Risk Paradox: Banks and Clearinghouses Under Regulation," https://academiccommons.columbia.edu/doi/10.7916/8x1h-9d95/download
13. 금융감독원, "K-ICS 내부모형 승인신청 매뉴얼," https://eiec.kdi.re.kr/policy/materialView.do?num=259269
14. 머니투데이, "2026년부터 보험사 자체 K-ICS 내부모형 도입," https://www.mt.co.kr/finance/2024/11/06/2024110517453616539
15. 금융소비자뉴스, "금감원, 보험사 자체 K-ICS 내부모형 도입," https://www.newsfc.co.kr/news/articleView.html?idxno=67403
16. Scribd, "K-ICS Manual (FSS)," https://www.scribd.com/document/741178854/K-ICS-MANUAL-FSS
17. 보험연구원, "K-ICS 영향분석," http://www.kiri.or.kr/pdf/연구자료/연구보고서/nre2024-14_3.pdf
18. arXiv, "Reinforcement Learning in Financial Decision Making," https://arxiv.org/html/2512.10913v1
19. ResearchGate, "Regulatory and Ethical Challenges of Using RL in Automated Financial Systems," https://www.researchgate.net/publication/392409713
20. 보험연구원, "국내 생명보험회사의 부채추종형 투자(LDI)전략 활용 및 시사점," https://www.kiri.or.kr/report/downloadFile.do?docId=6253

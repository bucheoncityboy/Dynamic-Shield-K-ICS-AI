# Dynamic Shield v3.0 - 완전 실행 가이드

## 사전 준비

```bash
conda activate quant
cd c:\Users\PC\Desktop\Quant\한화\Dynamic-Shield-K-ICS-AI\src
```

---

## 전체 실행 순서 (A to Z)

### Step 1: K-ICS 엔진 테스트
```bash
# K-ICS 엔진 (Ground Truth)
python core/kics_real.py

# AI Surrogate 모델 학습
python core/kics_surrogate.py
```

### Step 2: 시장 데이터 및 Regime 탐지
```bash
# Regime 탐지 (HMM)
python core/regime.py

# 하이브리드 시나리오 (TimeGAN)
python core/hybrid_scenarios.py

# TimeGAN 모델 확인 (선택)
python check_timegan_model.py

# TimeGAN 모델 사용 예시 (선택)
python use_timegan_model.py
```

### Step 3: RL 환경 및 에이전트
```bash
# RL 환경 테스트
python core/gym_environment.py

# 에이전트 (Safety Layer 포함)
python core/agent.py
```

### Step 4: PPO 학습
```bash
# PPO 학습 (main.py 사용 권장)
python main.py --mode train --timesteps 50000
```

### Step 5: 검증 및 분석
```bash
# 시스템 검증 (Surrogate, Latency, Safety)
python main.py --mode validate

# 또는 상세 검증
python validation/system_validation.py

# Risk Paradox 증명
python validation/proof_risk_paradox.py

# SHAP 분석
python validation/shap_analysis.py

# Efficient Frontier & 시각화
python validation/advanced_viz.py

# 스트레스 테스트 (Safety Layer VIX 주입)
python validation/stress_safety.py

# COVID-19 Solvency 분석
python validation/solvency_visualizer.py
```

### Step 6: 백테스트
```bash
# 전략 비교 백테스트
python main.py --mode backtest

# Walk-Forward 분석 (Jupyter 권장)
python -c "
from validation.backtest import BacktestEngine, load_real_market_data
engine = BacktestEngine()
data = load_real_market_data()
engine.run_walk_forward(data)
"
```

### Step 7: 실시간 모드
```bash
# 개별 모듈 테스트
python safety/risk_control.py
python realtime/latency.py
python realtime/async_engine.py
python realtime/intraday.py
python realtime/live_mode.py --interval 2 --steps 20

# 실시간 운영 모드 (Ctrl+C 종료)
python main.py --mode live --interval 2
```

### Step 8: 최종 검토
```bash
# Phase 6 최종 검토 스크립트
python phase6_final_review.py
```

---

## 파일 목록 (전체)

### core/ (핵심 엔진)
| 파일 | 역할 |
|---|---|
| `kics_real.py` | K-ICS 비율 계산 엔진 |
| `kics_surrogate.py` | AI Surrogate 모델 |
| `regime.py` | HMM 시장 국면 탐지 |
| `system.py` | 통합 시뮬레이션 환경 |
| `environment.py` | RL 환경 (레거시) |
| `gym_environment.py` | RL Gym 환경 |
| `agent.py` | RL 에이전트 + Safety Layer |
| `rl_trainer.py` | RL 학습기 (레거시) |
| `ppo_trainer.py` | PPO 학습기 |
| `hybrid_scenarios.py` | TimeGAN 하이브리드 시나리오 |
| `realistic_data.py` | 실제 데이터 로더 |
| `config_loader.py` | YAML 설정 로더 |

### safety/ (신규)
| 파일 | 역할 |
|---|---|
| `risk_control.py` | 독립 Safety Layer 모듈 |

### realtime/ (신규)
| 파일 | 역할 |
|---|---|
| `latency.py` | 지연시간 측정 |
| `async_engine.py` | 비동기 추론/학습 |
| `intraday.py` | 장중 피처 추정 |
| `live_mode.py` | 실시간 운영 루프 |

### validation/
| 파일 | 역할 |
|---|---|
| `backtest.py` | 백테스트 + Walk-Forward |
| `system_validation.py` | 통합 시스템 검증 |
| `proof_risk_paradox.py` | Risk Paradox 증명 |
| `shap_analysis.py` | SHAP 분석 |
| `advanced_viz.py` | Efficient Frontier |
| `stress_safety.py` | Safety Layer 스트레스 테스트 |
| `solvency_visualizer.py` | COVID-19 Solvency 분석 |

### 루트
| 파일 | 역할 |
|---|---|
| `main.py` | CLI 오케스트레이션 |
| `phase6_final_review.py` | 최종 검토 스크립트 |
| `colab_timegan_training.py` | TimeGAN 학습 (Colab) |
| `colab_use_timegan.py` | TimeGAN 사용 예시 (Colab) |
| `use_timegan_model.py` | TimeGAN 모델 사용 (로컬) |
| `check_timegan_model.py` | TimeGAN 모델 확인 |

### 저장된 모델
| 폴더 | 내용 |
|---|---|
| `timegan_model/` | 학습된 TimeGAN 모델 |
| `models/` | 기타 모델 파일 |

---

## 간편 실행 (권장)

```bash
python main.py --mode all    # 검증 → 학습 → 백테스트 자동
python main.py --mode live   # 실시간 테스트 (Ctrl+C 종료)
```

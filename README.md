# Dynamic Shield: K-ICS ìžë³¸ ìµœì í™” AI ì‹œìŠ¤í…œ

> **Capital Optimization, not Prediction**  
> í™˜ìœ¨ ì˜ˆì¸¡ì´ ì•„ë‹Œ ìžë³¸ ìµœì í™” - K-ICS ê·œì œ ëŒ€ì‘ ë™ì  í—¤ì§€ ì „ëžµ

[![Python](https://img.shields.io/badge/Python-3.11-blue.svg)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-red.svg)](https://pytorch.org/)

---

## ðŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

**Dynamic Shield**ëŠ” ë³´í—˜ì‚¬ì˜ K-ICS(ì‹ ì§€ê¸‰ì—¬ë ¥ì œë„) ìžë³¸ íš¨ìœ¨í™”ë¥¼ ìœ„í•œ AI ê¸°ë°˜ ë™ì  í—¤ì§€ ì‹œìŠ¤í…œìž…ë‹ˆë‹¤.

### í•µì‹¬ ë°œê²¬: Risk Paradox (ë¦¬ìŠ¤í¬ ì—­ì„¤)
> **100% í—¤ì§€ê°€ ìµœì„ ì´ ì•„ë‹ˆë‹¤!**  
> ì£¼ì‹-í™˜ìœ¨ ê°„ ìŒì˜ ìƒê´€ê´€ê³„(Natural Hedge)ë¥¼ í™œìš©í•˜ë©´ ë¶€ë¶„ í—¤ì§€ë¡œ ë” ë‚®ì€ ìœ„í—˜ê³¼ ë¹„ìš© ë‹¬ì„± ê°€ëŠ¥

---

## ðŸ† ì£¼ìš” ê²°ê³¼ (Synthetic Data)

### Phase 1: Risk Paradox ì¦ëª…
| ìƒê´€ê³„ìˆ˜ | ìµœì  í—¤ì§€ ë¹„ìœ¨ | ìžë³¸ ì ˆê°ë¥  |
|:---:|:---:|:---:|
| -0.6 | 0% | **17.69%** |
| -0.4 | 32% | **7.26%** |
| -0.2 | 67% | **1.63%** |

âœ… **ìŒì˜ ìƒê´€ê´€ê³„ì—ì„œ ë¶€ë¶„ í—¤ì§€ê°€ ì™„ì „ í—¤ì§€ë³´ë‹¤ íš¨ìœ¨ì ìž„ì„ ì¦ëª…**

### Phase 2: AI Surrogate Model
| ì§€í‘œ | ê²°ê³¼ |
|---|---|
| MAPE (Mean Absolute Percentage Error) | **0.0385%** |
| í™•ìž¥ì„± í…ŒìŠ¤íŠ¸ (10ë°° ìžì‚°) | Pass |
| ì¶”ë¡  ì†ë„ | ì‹¤ì‹œê°„ ê°€ëŠ¥ |

âœ… **MLP ì‹ ê²½ë§ì´ K-ICS ê³„ì‚°ì„ 0.04% ì˜¤ì°¨ë¡œ ê·¼ì‚¬**

### Phase 3: Regime Detection (HMM)
| ì‹œìž¥ êµ­ë©´ | VIX í‰ê·  | í—¤ì§€ ì „ëžµ |
|---|---|---|
| Normal | 14.88 | ë‚®ì€ í—¤ì§€ ìœ ì§€ |
| Transition | 15.21 | ì ì§„ì  ì¡°ì • |
| Panic | 26.45 | ê³ í—¤ì§€ ì „í™˜ |

âœ… **Hidden Markov Modelë¡œ 3ê°œ ì‹œìž¥ êµ­ë©´ ìžë™ ë¶„ë¥˜**

### Phase 4: RL Training (PPO)
| ì§€í‘œ | Q-Learning | **PPO** | ê°œì„ ë¥  |
|---|---|---|---|
| Avg Reward | -1.69 | **+63.21** | **37ë°°**|
| Min K-ICS | 4.2% | **341%** |  **81ë°°** |
| Safety Layer íŠ¸ë¦¬ê±° | - | 13,830íšŒ | - |

âœ… **PPO ì—ì´ì „íŠ¸ê°€ K-ICS 341% ìœ ì§€í•˜ë©° í•™ìŠµ (ê·œì œ ê¸°ì¤€ 100%ì˜ 3.4ë°°)**

### Phase 5: Backtesting (5ê°œ ì‹œë‚˜ë¦¬ì˜¤)
| ì „ëžµ | CAGR | MDD | RCR |
|---|---|---|---|
| 100% Hedge | -39.8% | -63.3% | -0.001 |
| 80% Fixed | -31.5% | -52.7% | 0.012 |
| Rule-based | -19.6% | -35.1% | 0.038 |
| **Dynamic Shield** | **-16.2%** | **-29.4%** | **0.047** |

âœ… **Dynamic Shieldê°€ ëª¨ë“  í•µì‹¬ ì§€í‘œì—ì„œ 1ìœ„**

### Efficient Frontier
| ì „ëžµ | Risk | Cost |
|---|---|---|
| 100% Hedge | 36.09% | 60.00% |
| **Dynamic Shield** | **33.84%** | **26.23%** |

âœ… **ë¦¬ìŠ¤í¬ 2.25%pâ†“, ë¹„ìš© 33.77%pâ†“ ë™ì‹œ ë‹¬ì„±**

---

## ðŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Dynamic Shield System                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ K-ICS Engineâ”‚  â”‚ AI Surrogateâ”‚  â”‚ Regime Detector     â”‚ â”‚
â”‚  â”‚ (Ground     â”‚â”€â”€â”‚ (MLP Neural â”‚â”€â”€â”‚ (Hidden Markov      â”‚ â”‚
â”‚  â”‚  Truth)     â”‚  â”‚  Network)   â”‚  â”‚  Model)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                â”‚                    â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                          â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚              PPO RL Agent (stable-baselines3)           â”‚â”‚
â”‚  â”‚  - State: [Hedge_Ratio, VIX, Correlation, SCR_Ratio]   â”‚â”‚
â”‚  â”‚  - Action: Continuous [-1, 1] â†’ Hedge Adjustment       â”‚â”‚
â”‚  â”‚  - Reward: Capital Efficiency - Cost - K-ICS Penalty   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    Safety Layer                         â”‚â”‚
â”‚  â”‚  - VIX > 30: Gradual De-risking                        â”‚â”‚
â”‚  â”‚  - K-ICS < 100%: Force 100% Hedge                      â”‚â”‚
â”‚  â”‚  - Max Step: Â±10% per period (ê¸‰ë°œì§„ ë°©ì§€)              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
í•œí™”/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/                      # í•µì‹¬ ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ kics_real.py           # K-ICS ì—”ì§„ (Ground Truth)
â”‚   â”‚   â”œâ”€â”€ kics_surrogate.py      # AI Surrogate ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ regime.py              # HMM ì‹œìž¥ êµ­ë©´ íƒì§€
â”‚   â”‚   â”œâ”€â”€ environment.py         # RL í™˜ê²½
â”‚   â”‚   â”œâ”€â”€ agent.py               # Dynamic Shield ì—ì´ì „íŠ¸
â”‚   â”‚   â”œâ”€â”€ gym_environment.py     # Gymnasium í˜¸í™˜ í™˜ê²½
â”‚   â”‚   â”œâ”€â”€ ppo_trainer.py         # PPO í›ˆë ¨ (stable-baselines3)
â”‚   â”‚   â”œâ”€â”€ rl_trainer.py          # Q-Learning í›ˆë ¨
â”‚   â”‚   â”œâ”€â”€ system.py              # í†µí•© ì‹œìŠ¤í…œ
â”‚   â”‚   â””â”€â”€ realistic_data.py      # í˜„ì‹¤ì  ë°ì´í„° ìƒì„±ê¸°
â”‚   â”‚
â”‚   â”œâ”€â”€ validation/                # ê²€ì¦ ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ backtest.py            # ë°±í…ŒìŠ¤íŒ…
â”‚   â”‚   â”œâ”€â”€ proof_risk_paradox.py  # Risk Paradox ì¦ëª…
â”‚   â”‚   â”œâ”€â”€ solvency_visualizer.py # K-ICS ë°©ì–´ ì‹œê°í™”
â”‚   â”‚   â”œâ”€â”€ stress_safety.py       # Safety Layer ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸
â”‚   â”‚   â”œâ”€â”€ advanced_viz.py        # Efficient Frontier ì‹œê°í™”
â”‚   â”‚   â””â”€â”€ shap_analysis.py       # Why Not 100% Hedge ë¶„ì„
â”‚   â”‚
â”‚   â”œâ”€â”€ phase6_final_review.py     # ìµœì¢… ê²€í†  ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ requirements.txt           # ì˜ì¡´ì„±
â”‚
â”œâ”€â”€ models/                        # í•™ìŠµëœ ëª¨ë¸
â”‚   â””â”€â”€ ppo_kics.zip
â”‚
â””â”€â”€ tensorboard_logs/              # í•™ìŠµ ë¡œê·¸
```

---

## ðŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. í™˜ê²½ ì„¤ì •
```bash
# Conda í™˜ê²½ ìƒì„± (Python 3.11 ê¶Œìž¥)
conda create -n quant python=3.11 pytorch cpuonly -c pytorch -y
conda activate quant

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r src/requirements.txt
conda install -c conda-forge hmmlearn -y

# Jupyter ì»¤ë„ ë“±ë¡ (ì„ íƒ)
python -m ipykernel install --user --name quant --display-name "(Quant)"
```

### 2. ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
```bash
cd src/core

# Phase 1: K-ICS Engine
python kics_real.py

# Phase 2: AI Surrogate + Regime Detection
python kics_surrogate.py
python regime.py

# Phase 3: System Integration
python system.py

# Phase 4: RL Training
python ppo_trainer.py  # PPO (ê¶Œìž¥)
# python rl_trainer.py  # Q-Learning (ëŒ€ì•ˆ)

# Phase 5: Validation
cd ../validation
python proof_risk_paradox.py
python solvency_visualizer.py
python backtest.py
python advanced_viz.py

# Phase 6: Final Review
cd ..
python phase6_final_review.py
```

### 3. TensorBoard ëª¨ë‹ˆí„°ë§
```bash
tensorboard --logdir=./tensorboard_logs/
# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:6006 ì ‘ì†
```

---

## ðŸ“Š ìƒì„±ë˜ëŠ” ì‹œê°í™” íŒŒì¼

| íŒŒì¼ëª… | ì„¤ëª… |
|---|---|
| `risk_paradox_proof.png` | Risk Paradox ì¦ëª… ê·¸ëž˜í”„ |
| `kics_defense_result.png` | COVID-19 ì‹œë‚˜ë¦¬ì˜¤ K-ICS ë°©ì–´ |
| `ppo_training_result.png` | PPO í•™ìŠµ ì§„í–‰ ê·¸ëž˜í”„ |
| `backtest_results.png` | ë°±í…ŒìŠ¤íŒ… ì„±ê³¼ ë¹„êµ |
| `efficient_frontier.png` | íš¨ìœ¨ì  íˆ¬ìžì„  |
| `counterfactual_dashboard.png` | ì˜ì‚¬ê²°ì • ê²½ê³„ |
| `shap_why_not_analysis.png` | Why Not 100% Hedge ë¶„ì„ |

---

## ðŸ”® í–¥í›„ ê³„íš: ì‹¤ì œ ë°ì´í„° ì ìš©

### Phase 1: ë°ì´í„° ìˆ˜ì§‘
| ë°ì´í„° | ì†ŒìŠ¤ | ìš©ë„ |
|---|---|---|
| VIX ì§€ìˆ˜ | Yahoo Finance / Bloomberg | ì‹œìž¥ ë³€ë™ì„± |
| USD/KRW í™˜ìœ¨ | í•œêµ­ì€í–‰ ECOS API | FX ë°ì´í„° |
| KOSPI ì§€ìˆ˜ | KRX | ì£¼ì‹-í™˜ìœ¨ ìƒê´€ê´€ê³„ |
| ê¸ˆë¦¬ (í•œ/ë¯¸) | FRED / í•œêµ­ì€í–‰ | ìŠ¤ì™‘ í¬ì¸íŠ¸ ê³„ì‚° |
| ì‹¤ì œ K-ICS ë°ì´í„° | ë³´í—˜ì‚¬ ë‚´ë¶€ | Ground Truth |

### Phase 2: ë°ì´í„° ì „ì²˜ë¦¬
- **ì¼ë³„ ìˆ˜ìµë¥  ê³„ì‚°**: `log(P_t / P_{t-1})`
- **ë¡¤ë§ ìƒê´€ê´€ê³„**: 60ì¼/120ì¼ ìœˆë„ìš°
- **GARCH ë³€ë™ì„± ì¶”ì •**: í´ëŸ¬ìŠ¤í„°ë§ íš¨ê³¼ ë°˜ì˜
- **ë ˆì§ ë¼ë²¨ë§**: VIX ê¸°ë°˜ Normal/Transition/Panic êµ¬ë¶„

### Phase 3: ëª¨ë¸ ìž¬í•™ìŠµ
```python
# ì‹¤ì œ ë°ì´í„°ë¡œ HMM ìž¬í•™ìŠµ
from core.regime import MarketRegimeDetector
detector = MarketRegimeDetector(n_regimes=3)
detector.fit(real_market_data)

# PPO ì—ì´ì „íŠ¸ ìž¬í•™ìŠµ
from core.ppo_trainer import PPOTrainer
trainer = PPOTrainer(total_timesteps=500000)  # ë” ë§Žì€ í•™ìŠµ
trainer.train()
```

### Phase 4: ë°±í…ŒìŠ¤íŒ…
- **ê¸°ê°„**: 2015-2024 (10ë…„)
- **ì‹œë‚˜ë¦¬ì˜¤**: 2015 ì¤‘êµ­ë°œ í­ë½, 2018 ê¸ˆë¦¬ì¸ìƒ, 2020 COVID, 2022 ê¸ˆë¦¬ì‡¼í¬
- **ë²¤ì¹˜ë§ˆí¬**: ì‹¤ì œ ë³´í—˜ì‚¬ í—¤ì§€ ì „ëžµ vs Dynamic Shield

### Phase 5: ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ êµ¬ì¶• (2-3ì£¼)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Production System                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Data Pipeline]                                        â”‚
â”‚   Bloomberg/Reuters â†’ Kafka â†’ Feature Store             â”‚
â”‚                                                         â”‚
â”‚  [Inference Engine]                                     â”‚
â”‚   AI Surrogate (ONNX) â†’ PPO Agent â†’ Safety Layer        â”‚
â”‚                                                         â”‚
â”‚  [Execution]                                            â”‚
â”‚   Hedge Signal â†’ Risk Manager Approval â†’ FX Desk        â”‚
â”‚                                                         â”‚
â”‚  [Monitoring]                                           â”‚
â”‚   Grafana Dashboard + Alert System                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“š ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  |
|---|---|
| ì–¸ì–´ | Python 3.11 |
| RL Framework | stable-baselines3, Gymnasium |
| ë”¥ëŸ¬ë‹ | PyTorch 2.0+ |
| ML | scikit-learn, hmmlearn |
| ì‹œê°í™” | Matplotlib, TensorBoard |
| ë°ì´í„° | NumPy, Pandas, SciPy |


